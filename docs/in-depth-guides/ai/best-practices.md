---
sidebar_label: Best Practices
title: Best Practices
zone_pivot_groups: dev-lang
description: Best practices for AI integration in Teams applications, including AI-generated message indicators, feedback collection for prompt improvement, and citation handling to ensure transparency and accuracy in AI responses.
---
# Best Practices

When sending messages using AI, Teams recommends a number of best practices to help with both user and developer experience.

## AI-Generated Indicator

::: zone pivot="csharp"
When sending messages using AI, Teams recommends including an indicator that the message was generated by AI. This can be done by calling the `.AddAIGenerated()` method on outgoing messages. This will help users understand that the message was generated by AI, and not by a human and can help with trust and transparency.
::: zone-end

::: zone pivot="python,typescript"
When sending messages using AI, Teams recommends including an indicator that the message was generated by AI. This can be done by adding a `addAiGenerated` property to outgoing message. This will help users understand that the message was generated by AI, and not by a human and can help with trust and transparency.
::: zone-end


::: zone pivot="csharp"
```csharp
var messageActivity = new MessageActivity
{
    Text = "Hello!",
}.AddAIGenerated();
```
::: zone-end

::: zone pivot="python"
```python
message_to_be_sent = MessageActivityInput(text="Hello!").add_ai_generated()
```
::: zone-end

::: zone pivot="typescript"
```typescript
const messageToBeSent = new MessageActivity('Hello!').addAiGenerated();
```
::: zone-end


![Screenshot of outgoing agent message to user marked with 'AI generated' badge.](/screenshots/ai-generated.gif)

## Gather feedback to improve prompts

AI Generated messages are not always perfect. Prompts can have gaps, and can sometimes lead to unexpected results. To help improve the prompts, Teams recommends gathering feedback from users on the AI-generated messages. See [Feedback](../feedback) for more information on how to gather feedback.

This does involve thinking through a pipeline for gathering feedback and then automatically, or manually, updating prompts based on the feedback. The feedback system is an point of entry to your eval pipeline.

## Citations

::: zone pivot="csharp"
AI generated messages can hallucinate even if messages are grounded in real data. To help with this, Teams recommends including citations in the AI Generated messages. This is easy to do by using the `AddCitation` method on the message.
::: zone-end

::: zone pivot="python,typescript"
AI generated messages can hallucinate even if messages are grounded in real data. To help with this, Teams recommends including citations in the AI Generated messages. This is easy to do by simply using the `addCitations` method on the message. This will add a citation to the message, and the LLM will be able to use it to generate a citation for the user.
::: zone-end

:::warning
Citations are added with a `position` property. This property value needs to also be included in the message text as `[<position>]`. If there is a citation that's added without the associated value in the message text, Teams will not render the citation
:::


::: zone pivot="csharp"
```csharp
var messageActivity = new MessageActivity
{
    Text = result.Content,
}.AddAIGenerated();

for (int i = 0; i < citedDocs.Length; i++)
{
    messageActivity.Text += $"[{i + 1}]";
    messageActivity.AddCitation(i + 1, new CitationAppearance
    {
        Name = citedDocs[i].Title,
        Abstract = citedDocs[i].Content
    });
}
```
::: zone-end

::: zone pivot="python"
```python
from microsoft.teams.api import MessageActivityInput, CitationAppearance

message_activity = MessageActivityInput(text=result.content).add_ai_generated()
for i, doc in enumerate(cited_docs):
    message_activity.text += f"[{i + 1}]"
    message_activity.add_citation(i + 1, CitationAppearance(name=doc["title"], abstract=doc["content"]))
```
::: zone-end

::: zone pivot="typescript"
```typescript
import { MessageActivity } from '@microsoft/teams.api';
// ...

const messageActivity = new MessageActivity(result.content).addAiGenerated();
for (let i = 0; i < citedDocs.length; i++) {
  const doc = citedDocs[i];
  // The corresponding citation needs to be added in the message content
  messageActivity.text += `[${i + 1}]`;
  messageActivity.addCitation(i + 1, {
    name: doc.title,
    abstract: doc.content,
  });
}
```
::: zone-end


![Animated screenshot showing user hovering over a footnote citation in agent response, and a pop-up showing explanatory text.](/screenshots/citation.gif)

## Suggested actions

::: zone pivot="csharp"
Suggested actions help users with ideas of what to ask next, based on the previous response or conversation. Teams recommends including suggested actions in your messages. You can do that by using the `WithSuggestedActions` method on the message. See [Suggested actions](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/prompt-suggestions) for more information on suggested actions.
::: zone-end

::: zone pivot="python"
Suggested actions help users with ideas of what to ask next, based on the previous response or conversation. Teams recommends including suggested actions in your messages. You can do that by using the `with_suggested_actions` method on the message. See [Suggested actions](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/prompt-suggestions) for more information on suggested actions.
::: zone-end

::: zone pivot="typescript"
Suggested actions help users with ideas of what to ask next, based on the previous response or conversation. Teams recommends including suggested actions in your messages. You can do that by using the `withSuggestedActions` method on the message. See [Suggested actions](https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/prompt-suggestions) for more information on suggested actions.
::: zone-end


::: zone pivot="csharp"
```csharp
var message = new MessageActivity
{
    Text = result.Content,
}.WithSuggestedActions(
    new Microsoft.Teams.Api.SuggestedActions() {
        To = [context.Activity.From.Id],
        Actions = [
            new Microsoft.Teams.Api.Cards.Action(ActionType.IMBack) {
                Title = "Thank you!",
                Value = "Thank you very much!"
                }
        ]
    }).AddAIGenerated();
await context.Send(message);
```
::: zone-end

::: zone pivot="python"
```python
from microsoft.teams.api import CardAction, CardActionType, MessageActivityInput, SuggestedActions

suggested_actions = SuggestedActions(
    to=[activity.from_.id],
    actions=[CardAction(type=CardActionType.IM_BACK, title="Thanks!", value="Thank you so much!")],
)
message = (
    MessageActivityInput(text=chat_result.response.content)
    .add_ai_generated()
    .with_suggested_actions(suggested_actions)
)
await ctx.send(message)
```
::: zone-end

::: zone pivot="typescript"
```typescript
message.withSuggestedActions({
  to: [activity.from.id],
  actions: [
    {
      type: 'imBack',
      title: 'Show pricing options',
      value: 'Show the pricing options available to me',
    },
  ],
});
```
::: zone-end

